# AI编程助手开发规则

## 📋 总体原则

### 🎯 核心要求
1. **文档驱动开发**: 所有开发活动必须基于 `docs/` 目录下的项目文档
2. **计划跟踪**: 严格按照 `docs/开发计划.md` 执行开发任务
3. **进度更新**: 每完成一个任务必须更新开发计划中的进度
4. **质量保证**: 遵循 `docs/开发指南.md` 中的编码规范和测试要求

## 📚 必读文档清单

### 🔴 开发前必读 (每次开发任务开始前)
1. **`docs/开发计划.md`** - 查看当前阶段任务和进度
2. **`docs/技术架构设计.md`** - 了解系统架构和模块设计
3. **`docs/API文档.md`** - 查看接口定义和数据模型

### 🟡 开发中参考
1. **`docs/开发指南.md`** - 编码规范、测试策略、调试方法
2. **`docs/技术选型报告.md`** - 技术选型依据和配置参数
3. **`docs/PRD.md`** - 功能需求和验收标准

### 🟢 开发后更新
1. **`docs/开发计划.md`** - 更新任务完成状态和开发日志
2. **`docs/API文档.md`** - 更新新增的API接口(如有)

## 🔄 开发工作流程

### 阶段1: 任务规划 📋
```
1. 查看 docs/开发计划.md 确定当前阶段和任务
2. 阅读 docs/技术架构设计.md 了解模块设计
3. 检查 docs/API文档.md 确认接口定义
4. 制定具体的实现计划
```

### 阶段2: 代码实现 💻
```
1. 遵循 docs/开发指南.md 中的编码规范
2. 按照 docs/技术架构设计.md 的模块结构开发
3. 实现 docs/API文档.md 中定义的接口
4. 参考 docs/技术选型报告.md 的配置建议
```

### 阶段3: 测试验证 🧪
```
1. 按照 docs/开发指南.md 编写单元测试
2. 验证 docs/PRD.md 中的功能需求
3. 检查性能是否满足 docs/PRD.md 的指标
4. 运行完整的测试套件
```

### 阶段4: 进度更新 📊
```
1. 更新 docs/开发计划.md 中的任务状态
2. 记录开发日志和遇到的问题
3. 更新完成情况统计
4. 规划下一步任务
```

## ✅ 任务执行规则

### 📝 开发计划更新规范

#### 任务状态更新
```markdown
# 更新任务状态示例
- [x] **创建项目目录结构** ✅ 已完成 (2025-01-19)
- [x] **配置管理模块** ✅ 已完成 (2025-01-19)
- [ ] **日志系统** ⏳ 进行中
- [ ] **数据模型定义** 📅 待开始
```

#### 开发日志记录
```markdown
### 2025-01-19
- ✅ 完成项目基础架构搭建
- ✅ 实现配置管理模块 (utils/config_loader.py)
- 🐛 问题: PaddleOCR模型下载失败 → 解决: 使用离线模型
- 🎯 下一步: 开发图像处理模块
```

### 🏗️ 代码开发规范

#### 文件创建规则
1. **目录结构**: 严格按照 `docs/开发指南.md` 中的项目结构
2. **命名规范**: 使用 `docs/开发指南.md` 中定义的命名约定
3. **模块导入**: 遵循 `docs/技术架构设计.md` 的依赖关系

#### 代码质量要求
```python
# 示例: 符合规范的代码结构
"""
模块文档字符串 - 参考 docs/开发指南.md
"""
from typing import List, Optional
import logging

logger = logging.getLogger(__name__)

class ExampleClass:
    """类文档字符串 - 参考 docs/API文档.md"""
    
    def __init__(self, config: dict) -> None:
        """初始化方法 - 参考 docs/API文档.md"""
        pass
    
    def example_method(self, param: str) -> Optional[str]:
        """方法文档字符串 - 参考 docs/API文档.md"""
        try:
            # 实现逻辑
            pass
        except Exception as e:
            logger.error(f"Error in example_method: {e}")
            raise
```

### 🧪 测试开发规则

#### 测试文件结构
```
tests/
├── test_core/
│   ├── test_ocr_engine.py      # 对应 core/ocr_engine.py
│   ├── test_date_parser.py     # 对应 core/date_parser.py
│   └── test_image_processor.py # 对应 core/image_processor.py
├── test_v1/
└── test_utils/
```

#### 测试编写要求
1. **覆盖率**: 每个模块测试覆盖率 ≥ 80%
2. **测试类型**: 单元测试、集成测试、性能测试
3. **测试数据**: 使用 `test_image/` 目录下的测试图片

## 📊 进度跟踪机制

### 🎯 每日检查清单
- [ ] 查看 `docs/开发计划.md` 确认今日任务
- [ ] 完成代码开发和测试
- [ ] 更新任务完成状态
- [ ] 记录开发日志
- [ ] 规划明日任务

### 📈 阶段完成检查
- [ ] 所有阶段任务已完成
- [ ] 测试覆盖率达标
- [ ] 性能指标满足要求
- [ ] 文档已更新
- [ ] 代码已提交

### 🔍 质量检查点
1. **代码质量**: 遵循 `docs/开发指南.md` 编码规范
2. **功能完整**: 满足 `docs/PRD.md` 功能需求
3. **性能达标**: 符合 `docs/PRD.md` 性能指标
4. **文档同步**: 代码与文档保持一致

## 🚨 异常处理规则

### 📋 计划偏差处理
```
1. 发现任务无法按计划完成时:
   - 分析原因并记录在开发日志中
   - 调整后续任务优先级
   - 更新开发计划时间估算
   - 必要时重新规划阶段目标
```

### 🐛 技术问题处理
```
1. 遇到技术难题时:
   - 查阅 docs/技术选型报告.md 寻找解决方案
   - 参考 docs/开发指南.md 调试方法
   - 记录问题和解决过程
   - 更新相关文档(如有必要)
```

### 📝 文档更新处理
```
1. 发现文档需要更新时:
   - 立即更新相关文档
   - 确保代码与文档一致
   - 通知团队成员(如有)
   - 记录更新原因和内容
```

## 🎯 成功标准

### ✅ 任务完成标准
1. **功能实现**: 代码实现了设计文档中的所有功能
2. **测试通过**: 所有测试用例通过，覆盖率达标
3. **文档更新**: 相关文档已同步更新
4. **计划更新**: 开发计划中的进度已更新

### 📊 阶段完成标准
1. **所有任务完成**: 阶段内所有任务状态为"已完成"
2. **质量达标**: 代码质量、性能指标符合要求
3. **文档完整**: 所有相关文档已更新
4. **测试验证**: 集成测试通过

### 🏆 项目完成标准
1. **功能完整**: V1版本所有功能正常运行
2. **性能达标**: 满足 `docs/PRD.md` 中的性能要求
3. **文档齐全**: 所有文档完整且与代码同步
4. **V2预留**: V2版本接口已预留并文档化

## 📞 支持资源

### 📚 参考文档
- **项目文档**: `docs/` 目录下所有文档
- **配置文件**: `config/` 目录下配置文件
- **测试数据**: `test_image/` 目录下测试图片

### 🔧 开发工具
- **代码编辑器**: 支持Python的IDE
- **测试工具**: pytest测试框架
- **代码检查**: black, flake8, mypy
- **版本控制**: Git

### 🆘 问题解决
1. **技术问题**: 查阅技术文档和开发指南
2. **进度问题**: 调整开发计划和任务优先级
3. **质量问题**: 参考编码规范和测试策略

---

**重要提醒**: 此规则文档是AI编程助手的行为准则，必须严格遵循。任何偏离都可能影响项目质量和进度。
